\section{Coordenadas y cambio de base}

Como ya mencionamos en la sección anterior, dada una base existe una única combinación lineal de elementos de la base para cada vector del espacio, esto nos permite generalizar el concepto de coordenadas. En esta sección abordaremos a más detalle este tema.


\begin{defi}
  Sea $V$ un $\F$-espacio vectorial de dimensión $n$, decimos que $B = (v_1, v_2, \ldots, v_n)$ es una \emph{base ordenada} si $\{v_1, v_2, \ldots, v_n\}$ es una base de $V$. Además, para todo $v \in V$ donde $v = \lambda_1 v_1 + \cdots + \lambda_n v_n$, definiremos su \emph{vector coordenada con respecto a $B$} como
    \[ [v]_B = \begin{pmatrix}
      v_1 \\ \vdots \\ v_n
    \end{pmatrix}.\]
\end{defi}

Notemos que bajo esta definición $(v_1, v_1, \ldots, v_n)$ y $(v_2, v_1, \ldots, v_n)$ son dos bases ordenadas distintas, al igual que cualquier otra permutación, aunque provengan de la misma base. De este modo nos aseguraremos que la coordenada de cualquier elemento sea única.

\begin{example}
  Consideremos el espacio vectorial $\R[x]_{\leq 2}$ junto la base ordenada $B = (1, x+1, x^2+1)$ y calculemos los vectores coordenadas con respecto a $B$ de: $x^2+5x-1$, $x^2 + 2x+1$ y $ax^2 + bx + c$.

  \examplesolution 

  Para el primero, recordemos que por definición la coordenada de $x^2+5x-1$ sobre $B$ es el vector $(\lambda_1, \lambda_2, \lambda_3)^t \in \R^3$ tal que
    \begin{align*}
      x^2+5x-1 &= \lambda_1 (1) + \lambda_2(x+1) + \lambda_3(x^2+1) \\
        &= \lambda_3 x^2 + \lambda_2x + (\lambda_1 + \lambda_2 + \lambda_3).
    \end{align*}  
    Igualando los coeficientes obtenemos un sistema de ecuaciones, resolviéndolo tenemos que $\lambda_3 = 1$, $\lambda_2 = 5$ y $\lambda_1 = -1 - \lambda_2 - \lambda_3 = -7$, así tenemos que
      \[
        [x^2+5x-1]_B = \begin{pmatrix} -7 \\ 5 \\ 1 \end{pmatrix},
      \]
    
    El proceso es el mismo para los polinomios $x^2 + 2x+1$ y $ax^2 + bx + c$, por lo que sus coordenadas son
    \[
        [x^2+2x+1]_B = \begin{pmatrix} -2 \\ 2 \\ 1 \end{pmatrix}
          \Eqand
        [ax^2+bx+c]_B = \begin{pmatrix} c-a-b \\b \\ a \end{pmatrix}.
      \]
\end{example}

Una propiedad interesante es que esta asociación de vectores de $V$ con las $n$-tuplas de $\F^n$ forma una transformación lineal biyectiva.

\begin{prop}
  Sea $B$ una base ordenada de un $\F$-espacio vectorial $V$ de dimensión $n$, entonces la función $[\cdot]_B\colon V \to \F^n$ es un isomorfismo.
\end{prop}
\begin{proof}
  Sean $v,w \in V$ con $v = \lambda_1 v_1 + \cdots + \lambda_n v_n$, $w = \mu_1 v_1 + \cdots + \mu_n v_n$ y $\alpha \in \F$, entonces vemos que
  \[
  \alpha v+w =  (\alpha\lambda_1+\mu_1) v_1 + \cdots + (\alpha\lambda_n+\mu_n) v_n,
  \]
  por lo que es claro que
  \begin{align*}
    [\alpha v+w]_B 
      &= \begin{pmatrix} \alpha\lambda_1+\mu_n \\ \vdots \\ \alpha\lambda_n+\mu_n \end{pmatrix} \\
      &= \alpha\begin{pmatrix} \lambda_1 \\ \vdots \\ \lambda_n \end{pmatrix}
       + \begin{pmatrix} \mu_n \\ \vdots \\ \mu_n  \end{pmatrix} \\
      &= \alpha[v]_B + [w]_B.
  \end{align*}
  Mostrando así, que es una transformación lineal. Para la inyectividad, es claro que si $[v]_B = (0,\cdots,0)$ entonces $v = 0v_1 + \cdots + 0v_n = 0$, por lo que $\ker([\cdot]_B) = \{0\}$. Para la suprayectividad, claramente tenemos que para todo $(\lambda_1, \ldots, \lambda_n)^t \in \F^n$ se cumple que $\lambda_1 v_1 + \cdots + \lambda_n v_n \in V$ y  $[\lambda_1 v_1 + \cdots  + \lambda_n v_n]_B = (\lambda_1, \ldots, \lambda_n)^t$.
\end{proof}


\subsection{Cambio de base}

Sabemos que dadas dos bases ordenadas $B = (v_1,\ldots,v_n)$ y $B' = (v_1',\ldots,v_n')$ de $V$ es posible definir un sistema de coordenadas para cada una, pero dado que modelan el mismo espacio, debería existir una forma de asociar ambas coordenadas, es decir, debería existir una función tal que dado el vector de coordenadas de $v \in V$ con respecto a $B$ nos devuelva su vector coordenada con respecto a $B'$. Más precisamente, buscamos que para $B$ y $B'$ exista una matriz invertible $M$ tal que $M [v]_B = [v]_{B'}$ para todo $v \in V$. A esta matriz la denotaremos como $M_{BB'}$ y la llamaremos como matriz de \emph{cambio de base} o \emph{cambio de coordenadas}.

La idea es la siguiente, si $e_i$ es la $i$-ésima columna de la matriz identidad, entonces por definición $[v_i]_B = e_i$, de este modo si $M_{BB'} [v]_B = [v]_{B'}$ para todo $v \in V$, entonces
  \[ M_{BB'} [v_i]_B = M_{BB'} e_i = (M_{BB'})_{*i} = [v_i]_{B'},\]
donde $(M_{BB'})_{*i}$ representa la $i$-ésima columna de la matriz $M_{BB'}$.
Esto nos dice que $[v_i]_{B'}$ es la $i$-ésima columna de la matriz $M_{BB'}$, en otras palabras que
  \[ M_{BB'} = \begin{spmatrix}{c|c|c}  [v_1]_{B'} & \cdots & [v_n]_{B'}  \end{spmatrix}. \]

\begin{teor} \label{teor:CambioBase}
  Sea $V$ un $\F$-espacio vectorial con bases ordenadas $B = (v_1,\ldots,v_n)$ y $B' = (v_1',\ldots,v_n')$, entonces existe una única matriz invertible $M_{BB'}$ tal que para todo $v \in V$ se cumple que
    \[ M_{BB'}[v]_B = [v]_{B'} \Eqand M_{BB'}^{-1}[v]_{B'} = [v]_B. \]
  Además $(M_{BB'})_{*i} = [v_i]_{B'}$ para todo $i \in \{1,\ldots,n\}$.
\end{teor}
\begin{proof}
  Primero, notemos que por propiedades conocidas y la definición de $M_{BB'}$ es claro que 
    \[ M_{BB'}[v_i]_B = M_{BB'} e_i =  (M_{BB'})_{*i} = [v_i]_{B'}. \]

  De este modo, sea $v \in V$ con $[v]_B = (\lambda_1,\ldots,\lambda_n)^t$, por la linealidad de $[\cdot]_{B'}$ y las propiedades ya mencionadas, tenemos que
    \begin{align*}
      v        &= \lambda_1 v_1 + \cdots + \lambda_n v_n, \\
      [v]_{B'} &= \lambda_1 [v_1]_{B'} + \cdots + \lambda_n [v_n]_{B'} \\
               &= \lambda_1 M_{BB'}[v_1]_B + \cdots + \lambda_n M_{BB'}[v_n]_B \\
               &= M_{BB'} [\lambda_1 v_1 + \cdots + \lambda_n v_n ]_B \\
               &= M_{BB'} [ v ]_B.
    \end{align*}
  De este modo $M_{BB'}[v]_B = [v]_{B'}$ para toda $v \in B$. Es fácil ver que si $M_{BB'}$ es invertible, entonces $M_{BB'}^{-1}[v]_{B'} = [v]_B$, así solo nos queda demostrar que $M_{BB'}$ es invertible.
  
  Consideremos el sistema de ecuaciones $M_{BB'}x = \bec 0$, como $[\cdot]_B$ es suprayectivo, entonces existe $v \in V$ tal que $[v]_B = x$, de este modo $M_{BB'}x = \bec 0$ implica que $M_{BB'}[v]_B = [v]_{B'} = \bec 0$. Ahora, recordemos por inyectividad de $[\cdot]_{B'}$ que $[v]_{B'} = \bec 0$ si y solo si $v = 0$, de este modo $x = [v]_{B} = \bec 0$, pero esto implica que $M_{BB'}x = \bec 0$ no tiene soluciones no triviales, así, por propiedades de las matrices, tenemos que $M_{BB'}$ es invertible.

  La unicidad se da por el análisis hecho al principio. Si existiera otra matriz $P$ con las mismas cualidades, entonces para todo $i \in \{1,\ldots, n\}$ cumple que
  \[ (M_{BB'})_{*i} = [v_i]_{B'} = P[v_i]_{B} = Pe_i = P_{*i},\]
  de este modo, dado que todas las columnas son iguales, se cumple que $P = M_{BB'}$.
\end{proof}

Este teorema nos afirma que si tenemos una base ordenada $B$, entonces para cualquier otra base ordenada $B'$ existe una matriz invertible asociada que realiza el cambio de coordenadas. La vuelta de esta proposición también es cierta, de este modo existe una biyección entre el conjunto de bases ordenadas y el conjunto de matrices invertibles.

\begin{prop}\label{prop:ExBase}
  Sea $P$ una matriz invertible de $n\times n$ con entradas en $\F$, $V$ un $\F$-espacio vectorial y $B = (v_1, \ldots, v_n)$ una base ordenada de $V$, entonces existe una única base ordenada $B'$ tal que $M_{B'B} = P$.
\end{prop}
\begin{proof}
  Si $P = (p_{ij})$ entonces definamos $B' = (v_1', \ldots, v_n')$ donde
    \[ v_j' = p_{1j}v_1 + \cdots +  p_{nj}v_n,     \qquad j \in \{1,\ldots, n\}. \]
  Notemos que $[v_i]_B = P_{*i}$ para toda $i \in 1,\ldots,n$, de este modo, si $B'$ fuese una base ordenada, entonces $P = M_{B'B}$, por el teorema anterior. Así probemos que $B'$ es una base ordenada.

  Sea $\lambda_1 v_i' + \cdots + \lambda_n v_n' = 0$, por linealidad de $[\cdot]_B$ y definición, tenemos que si $\lambda = (\lambda_1, \ldots, \lambda_n)^t$, entonces
  \begin{align*}
    [\lambda_1 v_i' + \cdots + \lambda_n v_n']_B &= \bec 0 \\
    \lambda_1 [v_1']_B + \cdots + \lambda_n [v_n']_B &= \bec 0 ,\\
    \lambda_1 P_{*1} + \cdots + \lambda_n P_{*n} &= \bec 0 ,\\
    P\lambda &= \bec 0.
  \end{align*}
  Ahora, como $P$ es invertible por hipótesis, entonces la única solución al sistema $Px = \bec 0$ es la trivial, de este modo $\lambda = \bec 0$ y por tanto $B'$ es una base ordenada.

  Ahora, para la unicidad, supongamos que existe otra base ordenada $B'' = (v_1'', \ldots, v_n'')$ tal que $P = M_{B''B}$, entonces, para toda $i \in \{1,\ldots,n\}$ se cumple que
  \[ [v_i'']_B =  P[v_i'']_{B''} = Pe_i = P[v_i']_{B'} = [v_i']_B, \]
  así, por la biyectividad de $[\cdot]_B$, tenemos que $v_i'' = v_i'$ para toda $i \in \{1,\ldots,n\}$, mostrando así que $B'' = B'$.
\end{proof}

\begin{example}
  Consideremos las bases ordenadas $B = ( 1, it )$ y $B' = (t+1, t-1)$ de $\C[t]_{\leq 1}$ y calculemos la matriz de cambio de coordenadas $M_{BB'}$.

  \examplesolution

  Por el teorema \ref{teor:CambioBase} sabemos que $M_{BB'} = \bigl( [1]_{B'} \mid [it]_{B'} \bigr)$, y se tienen las identidades
  \[
    1 = \frac{1}{2} (t+1) - \frac{1}{2}(t-1)
      \Eqand
    it =  \frac{i}{2}(t+1) + \frac{i}{2}(t-1),
  \]
  de esta forma tenemos que 
  \[ M_{BB'} = \begin{pmatrix}
    1/2  & i/2 \\
    -1/2 & i/2 \\
  \end{pmatrix}. \]
\end{example}

\begin{example}
  Consideremos las bases ordenadas $B = \bigl( (0,0,1)^t, (0,1,0)^t, (1,0,0)^t \bigr)$ y $B' = \bigl( (1,1,0)^t, (-1, 1, 0)^t, (0,0,-1)^t \bigr)$ de $\R^3$ y calculemos la matriz de cambio de coordenadas $M_{BB'}$.

  \examplesolution
  
  Aunque podríamos calcular de manera tradicional la matriz de cambio de coordenadas usando la definición de coordenada, existe un método más sencillo en este caso. Consideremos la base ordenada canónica $C = (e_1, e_2, e_3)$, es bastante claro que si $v \in \R^3$ entonces $[v]_C = v$, de esta forma tenemos que
  \[
    M_{BC} = \begin{pmatrix}
      0 & 0 & 1 \\
      0 & 1 & 0 \\
      1 & 0 & 0
    \end{pmatrix} \Eqand
    M_{B'C} = \begin{pmatrix}
      1 & -1 & 0 \\
      1 & 1  & 0 \\
      0 & 0  & -1
    \end{pmatrix}
  \]

  Ahora, dado que $M_{CB'} = M_{B'C}^{-1}$ veamos que $M_{B'C}^{-1} M_{BC}[v]_B = M_{B'C}^{-1}[v]_C = [v]_{B'}$, y por la unicidad de la matriz de cambio de base, entonces
  \begin{align*}
    M_{BB'} &= M_{B'C}^{-1} M_{BC} \\
      &= \begin{pmatrix}
        1 & -1 & 0 \\
        1 & 1  & 0 \\
        0 & 0  & -1
        \end{pmatrix}^{-1}
        \begin{pmatrix}
        0 & 0 & 1 \\
        0 & 1 & 0 \\
        1 & 0 & 0
        \end{pmatrix}  \\
      &= \begin{pmatrix}
        1/2  & 1/2 & 0 \\
        -1/2 & 1/2 & 0 \\
        0    & 0   & -1
        \end{pmatrix}
        \begin{pmatrix}
        0 & 0 & 1 \\
        0 & 1 & 0 \\
        1 & 0 & 0
        \end{pmatrix} \\
      &= \begin{pmatrix}
        0 & 1/2  & 1/2  \\
        0 & 1/2  & -1/2 \\
        -1 & 0    & 0
        \end{pmatrix}
  \end{align*}
\end{example}



\ExerciseSection

\begin{exerciselist}
  \item Demuestra que $v_1 = (1, 1, 0, 0)^t$, $v_2 = (0, 0, 1, 1)^t$, $v_3 = (1, 0, 0, 4)^t$ y $v_4 = (0, 0, 0, 2)^t$ forman una base de $\R^4$. Halla las coordenadas de cada uno de los vectores de la base canónica con respecto de la base ordenada $B = (v_1, v_2, v_3, v_4)$.
  
  \item Halla el vector de coordenadas de $(1, 0, 1)$ en la base de $\C^3$ formada por los vectores $(2i, 1, 0)$, $(2, -1, 1)$, $(0, 1+i, 1-i)$, en ese orden.
  
  \item Sea $V$ un $\F$-espacio vectorial de dimensión finita $n$ con una base ordenada $B$. Si $S = \{w_1, \ldots, w_n\} \subset V$, demuestra que $S$ es linealmente independiente si y solo si la matriz $M = \bigl( [w_1]_B \mid \cdots \mid [w_n]_B\bigr)$ es invertible.
  
  \item Sea $B = (v_1, v_2, v_3)$ la base ordenada de $\R^3$ formada por
    \[ 
      v_1 = \begin{pmatrix} 1 \\ 0 \\ -1 \end{pmatrix}, \quad
      v_2 = \begin{pmatrix} 1 \\ 1 \\ 1 \end{pmatrix}, \quad
      v_3 = \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}.
    \]
    ¿Cuáles son las coordenadas del vector $(a,b,c)$ en la base ordenada $B$?

  \item Sea $W$ el subespacio de $\C^3$ generado por $v_1 = (1, 0, i)^t$ y $v_2 = (1+i, 1, -1)^t$.
    \begin{enumerate}
      \item Demostrar que $v_1$ y $v_2$ forman una base de $W$.
      \item Demostrar que los vectores $w_1 = (1, 1, 0)^t$ y $w_2 = (1, i, 1+i)^t$ pertenecen a $W$ y forman otra base de $W$.
      \item ¿Cuales son las coordenadas de $v_1$ y $v_2$ en la base ordenada $(w_1, w_2)$ de $W$?
    \end{enumerate}
  
  \item Sean $v = (x_1, x_2)^t$ y $w = (y_1, y_2)^t$ dos vectores de $\R^2$ tales que
    \[ x_1 y_1 + x_2 y_2 = 0, \quad x_1^2 + x_2^2 = y_1^2 + y_2^2 = 1. \]
    Demostrar que $B = (v, w)$ es una base ordenada de $\R^2$. Hallar las coordenadas del vector $(a,b)^t$ en la base ordenada $B$. (Las condiciones impuestas a $v$ y $w$ dicen, geométricamente, que $v$ y $w$ son perpendiculares y de longitud 1.)

  \item Sea $V$ el espacio vectorial sobre los números complejos de todas las funciones de $\R$ en $\C$, sea $f_1(x) = 1$, $f_2(x) = e^{ix}$,  $f_3(x) = e^{-ix}$
    \begin{enumerate}
      \item Demostrar que $f_1$, $f_2$, $f_3$ son linealmente independientes.
      \item Sea $g_1(x)= 1$, $g_2(x) = \cos x$, $g_3(x) = \sen x$. Hallar una matriz invertible $P = (p_{ij})$ de $3 \times 3$ tal que
        \[ g_j = \sum_{i=1}^3 p_{ij} f_i, \qquad j \in \{1, 2, 3\}. \]
    \end{enumerate}

  \item Sea $t$ un número real fijo y defínase $g_1(x) = 1$, $g_2(x) = x+t$ y $g_3(x) = (x+t)^2$. Demuestra que $B = (g_1, g_2, g_3)$ es una base ordenada de $\R[x]_{\leq 2}$. Si $f(x) = ax^2 + bx + c$, ¿cuales son las coordenadas de $f$ en la base ordenada $B$?
\end{exerciselist}