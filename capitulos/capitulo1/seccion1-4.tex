\section{Semejanza de matrices}

Hemos visto que podemos asociar una matriz a cada transformación siempre que definamos unas bases ordenadas. El siguiente paso, es ver cómo obtener la matriz asociada de la misma transformación pero con bases diferentes. Esto lo haremos con la matriz de cambio de base.

\begin{teor}\label{teor:TLCambioBase}
  Sean $V$ y $W$ dos $\F$-espacios vectoriales y $T \colon V \to W$ una transformación lineal. Si $B_1$ y $B_2$ son bases ordenadas de $V$, $B_1'$ y $B_2'$ son bases ordenadas de $W$ entonces
  \[T_{B_2 B_2'} = M_{B_1' B_2'} T_{B_1 B_1'}M_{B_2 B_1}. \]
\end{teor}
\begin{proof}
  Sea $v \in V$, notemos, por definición y propiedades conocidas, que
  \begin{align*}
    M_{B_1' B_2'} T_{B_1 B_1'}M_{B_2 B_1} [v]_{B_2} &= M_{B_1' B_2'} T_{B_1 B_1'} [v]_{B_1} \\
      &= M_{B_1' B_2'} [T(v)]_{B_1'} \\
      &= [T(v)]_{B_2'}.
  \end{align*}
  Y por la unicidad de la matriz asociada, tenemos que $T_{B_2 B_2'} = M_{B_1' B_2'} T_{B_1 B_1'}M_{B_2 B_1}$.
\end{proof}

Notemos que en el teorema anterior las matrices $T_{B_1B_1'}$ y $T_{B_2B_2'}$ son distintas, pero son matrices asociadas a la misma transformación. Lo mismo ocurre con con la matriz de cambio de base, notemos que si $B$ y $B'$ son dos bases ordenadas de $V$ entonces $[\Id_V]_{BB'}[v]_B = [v]_B'$, por lo tanto $[\Id_V]_{BB'} = M_{BB'}$, dado que todas las matrices invertibles son de cambio de base, eso quiere decir que todas las matrices invertibles están asociadas a la transformación identidad, bajo unas ciertas bases.

Esta idea se puede generalizar: si $V$ y $W$ son $\F$-espacios vectoriales con bases ordenadas $B_1$ y $B_1'$, respectivamente, y $T\colon V \to W$ es una transformación lineal, si $M = PT_{B,B'}Q$ donde $P$ y $Q$ son dos matrices invertibles, por la proposición \ref{prop:ExBase} y el teorema anterior existirán bases ordenadas $B_2$ y $B_2'$ de $V$ y $W$, respectivamente, tales que $M = T_{B_2 B_2'}$. Esto quiere decir que todas las matrices de la forma $PT_{BB'}Q$, donde $P$ y $Q$ son dos matrices invertibles, están asociadas a $T$. Usando esta propiedad, podemos obtener la matriz más simple de una transformación lineal.

\begin{lema}
  Sea $M \in \M_{n\times m}(\F)$, si $r = \rango(M)$ entonces existen matrices invertible $P \in \M_n(\F)$ y $Q \in \M_m(\F)$ tales que
  \[ PMQ = \begin{spmatrix}{c|c}
    I_r & \bec 0 \\ \hline
    \bec 0 & \bec 0
  \end{spmatrix} = C_r.\]
\end{lema}
\begin{proof}
  Supongamos que $M$ está en su forma escalonada reducida por renglones. Notemos que si llevamos la matriz $M^t$ a su forma escalonada reducida por renglones, ésta matriz tiene la forma pedida. Es decir, existe una matriz invertible $E \in \M_m(\F)$ tal que 
  \[
    EM^t = C_r \implies ME^t = (C_r)^t = C_r.
  \]
  De este modo, si $Q = E^t$, dado que $E$ es invertible entonces $Q$ es invertible y hemos probado lo pedido.

  Ahora si $M$ es una matriz cualquiera, existe una matriz invertible$P\in\M_n(\F)$ tal que $PM$ es la forma escalonada reducida por renglones de $M$ y por la parte anterior existe una matriz invertible $Q \in \M_m(\F)$ tal que
    \[
      PMQ = C_r.
    \]
\end{proof}

\begin{teor}
  Sea $V$ y $W$ espacios vectoriales de dimensión $n$ y $m$, respectivamente, si $T \colon V \to W$ es una transformación lineal, entonces existen bases ordenadas $B$ de $V$ y $B$ de $W$ tal que
  \[
    T_{BB'} =  \begin{spmatrix}{c|c}
      I_r & \bec 0 \\ \hline
      \bec 0 & \bec 0
    \end{spmatrix} = C_r.
  \]
\end{teor}

\begin{proof}
  Sean $B_0$ y $B_0'$ dos bases ordenadas cualquiera de $V$ y $W$, por el lema anterior, existen matrices invertibles $P \in \M_m(\F)$ y $Q \in \M_n(\F)$ tal que
    \[
      PT_{B_0B_0'} Q = C_r
    \]
  Ahora, por la proposición \ref{prop:ExBase} y el teorema \ref{teor:TLCambioBase} existen bases $B$ de $V$ y $B'$ de $W$ tal que $Q = M_{BB_0}$ y $P = M_{B'B_0'}$ y por lo tanto
  \[
    T_{BB'} = M_{B'B_0'} T_{B_0B_0'} M_{BB_0} = C_r. \qedhere
  \]
\end{proof}

La matriz $C_r$ del teorema anterior es conocida como la \emph{matriz canónica de equivalencia} y es la matriz asociada más simple.

A pesar de esto, un caso de mayor interés son las matrices asociadas cuando $T$ es un endomorfismo de $V$ sobre la misma base. Si $B$ es una base ordenada de $V$, definiremos $T_B = T_{BB}$. Notemos que si deseamos obtener $T_{B'}$, dado que $M_{BB'} = (M_{B'B})^{-1}$ entonces 
  \[ T_{B'} = (M_{B'B})^{-1} T_B M_{B'B} \]
y de nuevo,por la proposición \ref{prop:ExBase} podemos ver que todas las matrices $P^{-1}T_{B}P$, donde $P$ es una matriz invertible, están asociadas a la misma transformación. De esta forma, la meta será agrupar todas las matrices que están asociadas a una misma transformación lineal.

\begin{defi}
  Sean $M$ y $N$ dos matrices de $n \times n$ con elementos en $\F$, se dice que $M$ es \emph{semejante} a $N$ si existe una matriz invertible $P$ tal que $M = P^{-1}NP$, lo que denotaremos como $M \sim N$.
\end{defi}

Como se puede intuir, la semejanza de matrices es una relación de equivalencia. Todas las clases de equivalencia tienen como común que las matrices que las componen están asociadas a una misma transformación lineal, además las clases de equivalencia de la matriz $\bec 0$ y la identidad $I_n$ están compuestas unicamente de éstas. 

\begin{prop} \label{prop:invdetytr}
  Sean $M,N \in \M_n(\F)$ tales que $M \sim N$, entonces $\det(M) = \det(N)$ y $\tr(M) = \tr(N)$.
\end{prop}
\begin{proof}
  Por definición, existe una matriz invertible $P$ tal que $M = P^{-1}NP$. La primera igualdad es fácil de probar, ya que por por propiedad de la determinante tenemos  que
  \begin{align*}
    \det(M) &= \det(P^{-1}NP) = \det(P^{-1})\det(N) \det(P)  \\
      &= \bigl(\det(P)\bigr)^{-1} \det(N) \det(P) = \bigl(\det(P)\bigr)^{-1}\det(P)\det(N)  \\
      &= \det(N).
  \end{align*}
  
  Para la segunda propiedad, notemos que si $A,B \in \M_n(\F)$ dado por $A = (a_{ij})$ y $B = (b_{ij})$ entonces
  \begin{align*}
    \tr(AB) &= \sum_{i=1}^n (AB)_{ii} = \sum_{i=1}^n \sum_{j=1}^n a_{ij} b_{ji} \\
      &=  \sum_{j=1}^n \sum_{i=1}^n b_{ji} a_{ij} = \sum_{j=1}^n (BA)_{jj} \\
      &= \tr(BA).
  \end{align*}
  De esta forma, tenemos que por definición y la propiedad anterior
  \[ \tr(M) = \tr(P^{-1}NP) = \tr([P^{-1}N]P) = \tr(P[P^{-1}N]) = \tr(I_n N) = \tr(N). \]
\end{proof}

Esta propiedad nos muestra que todas las matrices asociadas a una transformación lineal, y por tanto pertenecientes a la misma clases de equivalencia, tienen la misma determinante y traza, en otras palabras, la traza y determinante son invariantes ante el cambio de base.


\ExerciseSection

\begin{exerciselist}
  \item Sea $T$ la transformación lineal de $\R^3$ a $\R^2$ dada por $T\bigl((x_1, x_2, x_3)^t\bigr) = (x_1 - x_2, x_2 - x_3)^t$
    \begin{enumerate}
      \item Encuentre la matriz asociada a $T$ sobre la bases canónicas de $\R^3$ y $\R^2$.
      \item A partir de la matriz encontrada en el inciso anterior, encuentre la matriz asociada a $T$ con respecto a las bases $B = \bigl( (0, 1, 1)^t, (1, 0, 1)^t, (1, 1, 0)^t \bigr)$ y $B' = \bigl( (1, 0)^t, (1, 1)^t \bigr)$.
    \end{enumerate}

  \item Demuestra que la semejanza de matrices es una relación de semejanza. Es decir, demuestra las siguientes propiedades
    \begin{enumerate}
      \item (Reflexividad) $M \sim M$ para todo $M \in \M_n(\F)$.
      \item (Simetría) Para cualesquiera $M,N \in \M_n(\F)$ si $M \sim N$ entonces $N \sim M$.
      \item (Transitividad) Para cualesquiera $M,N,P \in \M_n(\F)$ si $M \sim N$ y $N \sim P$ entonces $M \sim P$.
    \end{enumerate}
  
  \item Demuestra que las clases de equivalencia de la matriz cero e identidad solo contienen a éstas.
\end{exerciselist}